VERSION 5.00
Object = "{65996203-3B87-11D4-A21F-00E029189826}#6.9#0"; "TLIST6.OCX"
Begin VB.Form frm¦r§Îµ²ºc 
   Caption         =   "¦r§Îµ²ºc"
   ClientHeight    =   3492
   ClientLeft      =   60
   ClientTop       =   348
   ClientWidth     =   9228
   Icon            =   "frm¦r§Îµ²ºc.frx":0000
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MDIChild        =   -1  'True
   ScaleHeight     =   3492
   ScaleWidth      =   9228
   Visible         =   0   'False
   Begin TListProLibCtl.TList tree¦r§Î¾ğª¬µ²ºc 
      DragIcon        =   "frm¦r§Îµ²ºc.frx":030A
      Height          =   2652
      Left            =   300
      TabIndex        =   0
      Top             =   240
      Width           =   3852
      _Version        =   393225
      _ExtentX        =   6800
      _ExtentY        =   4683
      _StockProps     =   228
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "¼Ğ·¢Åé"
         Size            =   12
         Charset         =   136
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      BorderStyle     =   1
      Appearance      =   1
      ForeColor       =   -2147483640
      BackColor       =   -2147483643
      SelForeColor    =   -2147483634
      SelBackColor    =   -2147483635
      ShiftStep       =   300
      ItemImageDefHeight=   228
      ItemImageDefWidth=   228
      WidthOfText     =   0
      TabStopDistance =   0
      MarkHeight      =   0
      MarkWidth       =   0
      TitleHeight     =   0
      XOffset         =   0
      TriggerEvents   =   0
      PathSeparator   =   "\"
      Caption         =   ""
      FixedSize       =   0   'False
      ShowChildren    =   0   'False
      ExpandChildren  =   0   'False
      ExpandNewItem   =   0   'False
      Scrollbars      =   3
      PictureOpen     =   "frm¦r§Îµ²ºc.frx":074C
      PictureClosed   =   "frm¦r§Îµ²ºc.frx":085E
      PictureLeaf     =   "frm¦r§Îµ²ºc.frx":0970
      PictureMark     =   "frm¦r§Îµ²ºc.frx":0A82
      ImageStretch    =   0   'False
      NoIntegralHeight=   -1  'True
      DisableNoScroll =   0   'False
      NoPictureRoot   =   0   'False
      MSOutlineAdd    =   0   'False
      BackwardCompatibility=   0   'False
      InvStyle        =   0
      ViewStyle       =   0
      PictureType     =   0
      CurrentIndexMethod=   0
      ViewStyleEx     =   1
      AutoExpand      =   1
      TreeLinesStyle  =   0
      PicInMultiLine  =   0
      ShowCaption     =   0
      ShowTitles      =   0
      AutoScrDuringDragDrop=   0
      DragHighlight   =   0
      MousePointer    =   0
      DefMultiLine    =   0   'False
      SmartDragDrop   =   0   'False
      WidthOfTextMin  =   0
      DrawFocusRect   =   0   'False
      LcPresent       =   -1  'True
      WebTargetFrame  =   ""
      WebURLBase      =   ""
      GradientStyle   =   0
      TransparentBackground=   0   'False
      DefBorderStyle  =   0
      DefPictureAlignment=   5
      DefAlignment    =   0
      DefTextAlignment=   2
      ShowHiddenItems =   0   'False
      DefItemCellBackColor=   583057600
      _InternalVersion=   524290
      ExchangeSerialNumber=   "frm¦r§Îµ²ºc.frx":0B7C
      DragIconStyle   =   0
      ExchangeDefItemCellDef=   "frm¦r§Îµ²ºc.frx":0BC9
      _ChkCounter     =   -1
      TreeLinesHighlightColor=   -2113929196
      TreeLinesShadowColor=   -2113929200
   End
   Begin VB.Image imgQuestion 
      Height          =   156
      Left            =   5580
      Picture         =   "frm¦r§Îµ²ºc.frx":0CD0
      Top             =   2976
      Width           =   156
   End
   Begin VB.Image img¬Ù¥çÁn 
      Height          =   240
      Left            =   7920
      Picture         =   "frm¦r§Îµ²ºc.frx":0DBA
      Top             =   2000
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img¥çÁn 
      Height          =   240
      Left            =   7320
      Picture         =   "frm¦r§Îµ²ºc.frx":14CC
      Top             =   2000
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img¬Ù¸q 
      Height          =   240
      Left            =   6120
      Picture         =   "frm¦r§Îµ²ºc.frx":1BDE
      Top             =   1600
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img¬Ù§Î 
      Height          =   240
      Left            =   5520
      Picture         =   "frm¦r§Îµ²ºc.frx":22F0
      Top             =   1600
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img§Î 
      Height          =   240
      Left            =   5520
      Picture         =   "frm¦r§Îµ²ºc.frx":2A02
      Top             =   1200
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img§ÎÁn 
      Height          =   240
      Left            =   7320
      Picture         =   "frm¦r§Îµ²ºc.frx":3114
      Top             =   800
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img·|·N 
      Height          =   240
      Left            =   6720
      Picture         =   "frm¦r§Îµ²ºc.frx":3826
      Top             =   800
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img«ü¨Æ 
      Height          =   240
      Left            =   6120
      Picture         =   "frm¦r§Îµ²ºc.frx":3F38
      Top             =   800
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img¶H§Î 
      Height          =   240
      Left            =   5520
      Picture         =   "frm¦r§Îµ²ºc.frx":464A
      Top             =   800
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image imgPin 
      Height          =   264
      Left            =   6720
      Picture         =   "frm¦r§Îµ²ºc.frx":4D5C
      Top             =   240
      Visible         =   0   'False
      Width           =   288
   End
   Begin VB.Image imgPinPush 
      Height          =   264
      Left            =   6120
      Picture         =   "frm¦r§Îµ²ºc.frx":4EE6
      Top             =   240
      Visible         =   0   'False
      Width           =   288
   End
   Begin VB.Image imglock 
      Height          =   264
      Left            =   0
      Picture         =   "frm¦r§Îµ²ºc.frx":5070
      Tag             =   "0"
      ToolTipText     =   "Âê©w"
      Top             =   240
      Width           =   288
   End
   Begin VB.Image img¼Ğ¥Ü 
      Height          =   240
      Left            =   7320
      Picture         =   "frm¦r§Îµ²ºc.frx":51FA
      Top             =   1200
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img¸q 
      Height          =   240
      Left            =   6120
      Picture         =   "frm¦r§Îµ²ºc.frx":590C
      Top             =   1200
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img¬ÙÁn¸q 
      Height          =   240
      Left            =   7920
      Picture         =   "frm¦r§Îµ²ºc.frx":601E
      Top             =   1600
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img¥| 
      Height          =   240
      Left            =   8520
      Picture         =   "frm¦r§Îµ²ºc.frx":6730
      Top             =   2400
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img¤T 
      Height          =   240
      Left            =   7920
      Picture         =   "frm¦r§Îµ²ºc.frx":6C86
      Top             =   2400
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img¤G 
      Height          =   240
      Left            =   7320
      Picture         =   "frm¦r§Îµ²ºc.frx":71A4
      Top             =   2400
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img¥b 
      Height          =   240
      Left            =   6720
      Picture         =   "frm¦r§Îµ²ºc.frx":76BE
      Top             =   2400
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img­Ë 
      Height          =   240
      Left            =   6120
      Picture         =   "frm¦r§Îµ²ºc.frx":7C14
      Top             =   2400
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img¤Ï 
      Height          =   240
      Left            =   5520
      Picture         =   "frm¦r§Îµ²ºc.frx":81BA
      Top             =   2400
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image imgÁn¸q 
      Height          =   240
      Left            =   7320
      Picture         =   "frm¦r§Îµ²ºc.frx":8718
      Top             =   1600
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image img¬ÙÁn 
      Height          =   240
      Left            =   6720
      Picture         =   "frm¦r§Îµ²ºc.frx":8E2A
      Top             =   1600
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image imgÁn 
      Height          =   240
      Left            =   6720
      Picture         =   "frm¦r§Îµ²ºc.frx":953C
      Top             =   1200
      Visible         =   0   'False
      Width           =   432
   End
   Begin VB.Image imgNull 
      Height          =   384
      Left            =   5520
      Picture         =   "frm¦r§Îµ²ºc.frx":9C4E
      Top             =   200
      Visible         =   0   'False
      Width           =   384
   End
   Begin VB.Image img¬Ù 
      Height          =   240
      Left            =   7920
      Picture         =   "frm¦r§Îµ²ºc.frx":A490
      Top             =   1200
      Visible         =   0   'False
      Width           =   432
   End
End
Attribute VB_Name = "frm¦r§Îµ²ºc"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Private µøµ¡¥N½X As Integer, µøµ¡ As String, ÀË¦rªí As Recordset
Private °Ï°ì¦rÅé°}¦C(0 To ¦rÅé­Ó¼Æ) As Variant
Private XCheck As Single, YCheck As Single
Private ¼Ğ°O­Ó¼Æ As Integer, ²Õ¦r²Å¸¹ As Integer, ¤»®Ñ As Integer
Private Const ¶H§Î¥N½X = 1, «ü¨Æ¥N½X = 2, ·|·N¥N½X = 3, §ÎÁn¥N½X = 4
Private Const §Î¥N½X = 5, ¸q¥N½X = 6, Án¥N½X = 7, ¼Ğ¥Ü¥N½X = 8, ¬Ù¥N½X = 9
Private Const ¬Ù§Î¥N½X = 10, ¬Ù¸q¥N½X = 11, ¬ÙÁn¥N½X = 12, Án¸q¥N½X = 13, ¬ÙÁn¸q¥N½X = 14
Private Const ¥çÁn¥N½X = 15, ¬Ù¥çÁn¥N½X = 16
Private Const ¤Ï¥N½X = 17, ­Ë¥N½X = 18, ¥b¥N½X = 19, ¤G¥N½X = 20, ¤T¥N½X = 21, ¥|¥N½X = 22

Private Sub Form_Activate()
²{¥Îµøµ¡ = µøµ¡
'²{¥Îµøµ¡¥N½X = µøµ¡¥N½X
²{¥Îµøµ¡¥N½X = ¦r§Îµ²ºc¥N½X
¤Á´«¿ï¨ú¦r§Î¤u¨ã¦Cª¬ºA ²{¥Îµøµ¡¥N½X
tree¦r§Î¾ğª¬µ²ºc_Click
mdiº~¦r¦r§Î.txtª¬ºA = µ²ºcª¬ºA¦C

End Sub

Private Sub Form_Load()
Dim i As Integer
Dim ¦r®Ú§Ç As String, ½s¸¹ As Long

±Ò°Ê¦r§Îµ²ºc = True
If ªì©lfirst <> 1 Then
   If ¤w¸ü¤Jµe­± = 0 Then
      If µ²ºcwinstate = 0 Then
         frm¦r§Îµ²ºc.Left = µ²ºcleft
         frm¦r§Îµ²ºc.Top = µ²ºctop
         frm¦r§Îµ²ºc.Height = µ²ºcheight
         frm¦r§Îµ²ºc.Width = µ²ºcwidth
      Else
         frm¦r§Îµ²ºc.WindowState = µ²ºcwinstate
      End If
   ElseIf ±Ò°Ê¦r§Î´F¨Å Then
         frm¦r§Îµ²ºc.Left = frm¦r§Î´F¨Å.Left + frm¦r§Î´F¨Å.Width
         frm¦r§Îµ²ºc.Top = frm¦r§Î´F¨Å.Top
         frm¦r§Îµ²ºc.Height = frm¦r§Î´F¨Å.Height
         frm¦r§Îµ²ºc.Width = frm¦r§Î´F¨Å.Width
   End If
End If

tree¦r§Î¾ğª¬µ²ºc.FontSize = CInt(Åã¥Ü¦r«¬¤j¤p)

tree¦r§Î¾ğª¬µ²ºc.MarkPicture(0) = imgNull

tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¶H§Î¥N½X) = img¶H§Î
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(«ü¨Æ¥N½X) = img«ü¨Æ
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(·|·N¥N½X) = img·|·N
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(§ÎÁn¥N½X) = img§ÎÁn

tree¦r§Î¾ğª¬µ²ºc.MarkPicture(§Î¥N½X) = img§Î
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¸q¥N½X) = img¸q
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(Án¥N½X) = imgÁn
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¼Ğ¥Ü¥N½X) = img¼Ğ¥Ü
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¬Ù¥N½X) = img¬Ù

tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¬Ù§Î¥N½X) = img¬Ù§Î
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¬Ù¸q¥N½X) = img¬Ù¸q
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¬ÙÁn¥N½X) = img¬ÙÁn
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(Án¸q¥N½X) = imgÁn¸q
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¬ÙÁn¸q¥N½X) = img¬ÙÁn¸q
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¥çÁn¥N½X) = img¥çÁn
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¬Ù¥çÁn¥N½X) = img¬Ù¥çÁn

tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¤Ï¥N½X) = img¤Ï
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(­Ë¥N½X) = img­Ë
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¥b¥N½X) = img¥b
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¤G¥N½X) = img¤G
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¤T¥N½X) = img¤T
tree¦r§Î¾ğª¬µ²ºc.MarkPicture(¥|¥N½X) = img¥|

'Me.Tag = ¦@¥Îµøµ¡¥N½X
Me.Tag = ¦r§Îµ²ºc¥N½X
µøµ¡¥N½X = ¦@¥Îµøµ¡¥N½X
µøµ¡ = ¦@¥Îµøµ¡(¦@¥Îµøµ¡¥N½X)
tree¦r§Î¾ğª¬µ²ºc.AddItem ""
'tree¦r§Î¾ğª¬µ²ºc.ListIndex = 0
tree¦r§Î¾ğª¬µ²ºc.Image(0) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf

If ¨t²Î¦rÅé = "·¢®Ñ" Then
    Set ÀË¦rªí = ·¢®ÑÀË¦rªí
ElseIf ¨t²Î¦rÅé = "¤p½f" Then
    Set ÀË¦rªí = ¤p½fÀË¦rªí
ElseIf ¨t²Î¦rÅé = "ª÷¤å" Then
    Set ÀË¦rªí = ª÷¤åÀË¦rªí
ElseIf ¨t²Î¦rÅé = "¥Ò°©¤å" Then
    Set ÀË¦rªí = ¥Ò°©¤åÀË¦rªí
ElseIf ¨t²Î¦rÅé = "·¡¨t¤å¦r" Then
    Set ÀË¦rªí = ·¡¨t¤å¦rÀË¦rªí
End If

i = 0
Do While ¦rÅé°}¦C(i) <> ""
   °Ï°ì¦rÅé°}¦C(i) = ¦rÅé°}¦C(i)
   i = i + 1
Loop


If ¬O§_¬°²Õ¦r²Å¸¹(mdiº~¦r¦r§Î.txt¦r§Î.Text, 1, 14) = 0 Then
   'If Mid(mdiº~¦r¦r§Î.txt¦r§Î.FontName, 1, 3) <> "hzk" Then
   '   ÀË¦rªí.Index = "¦r§Î"
   '   ÀË¦rªí.Seek "=", mdiº~¦r¦r§Î.txt¦r§Î.Text
   'Else
      ·¢®ÑÀË¦rªí.Index = "½s¸¹"
      ·¢®ÑÀË¦rªí.Seek "=", ¨t²Î½s¸¹
   'End If
   
   If Not ·¢®ÑÀË¦rªí.NoMatch Then
      Do While Not ·¢®ÑÀË¦rªí.NoMatch
         ½s¸¹ = ·¢®ÑÀË¦rªí.Fields("½s¸¹")
         Exit Do
         ·¢®ÑÀË¦rªí.MoveNext
       Loop
    End If
    ¸ü¤J¦r§Î "¼Ğ·¢Åé", mdiº~¦r¦r§Î.txt¦r§Î.Text, ½s¸¹
End If

End Sub

Private Sub Form_Resize()

If Me.ScaleHeight - tree¦r§Î¾ğª¬µ²ºc.Top * 2 > 0 Then tree¦r§Î¾ğª¬µ²ºc.Height = Me.ScaleHeight - tree¦r§Î¾ğª¬µ²ºc.Top * 2
If Me.ScaleWidth - tree¦r§Î¾ğª¬µ²ºc.Left * 2 > 0 Then tree¦r§Î¾ğª¬µ²ºc.Width = Me.ScaleWidth - tree¦r§Î¾ğª¬µ²ºc.Left * 2

End Sub


Private Sub Form_Unload(Cancel As Integer)
mdiº~¦r¦r§Î.mnu_¦r§Îµ²ºc.Enabled = True
±Ò°Ê¦r§Îµ²ºc = False
­pºâ²{¥Îµøµ¡

End Sub


Public Sub ¸ü¤J¦r§Î(¨t²Î¦rÅé As String, val¦r§Î As String, ¨t²Î½s¸¹ As Long)
Dim ³¡¥ó§Ç As String
Dim ¦r§Î As String, ¦rÅé½s¸¹ As Integer, ¦r«¬ÀÉ As String, ¤À¸Ñ As Integer
Dim i As Integer, ½s¸¹ As Long
Dim ¸Ñ§Î As String
Dim ÀË¬d²Õ¦r²Å¸¹ As Boolean, ¤£¬O²Õ¦r²Å¸¹ As Boolean

½s¸¹ = ¨t²Î½s¸¹
If imglock.Tag = 1 Then Exit Sub
If ½s¸¹ <= 0 Then Exit Sub

Screen.MousePointer = ccHourglass

ÀË¬d²Õ¦r²Å¸¹ = False
¦r§Î = val¦r§Î
If ¨t²Î¦rÅé = "¥_®v¤j»¡¤å¤p½f" Or ¨t²Î¦rÅé = "¥_®v¤j»¡¤å­«¤å" Then
    Set ÀË¦rªí = ¤p½fÀË¦rªí
ElseIf ¤¤¬ã°|ª÷¤å(¨t²Î¦rÅé) Then
    If ¨t²Î¦rÅé <> "¤¤¬ã°|ª÷¤å" Then
        ª÷¤å²§¼g¦rªí.Seek "=", ½s¸¹
        If Not IsNull(ª÷¤å²§¼g¦rªí.Fields("ÀË¦r½s¸¹")) Then
            ½s¸¹ = ª÷¤å²§¼g¦rªí.Fields("ÀË¦r½s¸¹")
        End If
    End If
    Set ÀË¦rªí = ª÷¤åÀË¦rªí
ElseIf ¤¤¬ã°|¥Ò°©¤å(¨t²Î¦rÅé) Then
    If ¨t²Î¦rÅé <> "¤¤¬ã°|¥Ò°©¤å" Then
        ¥Ò°©¤å²§¼g¦rªí.Seek "=", ½s¸¹
        If Not IsNull(¥Ò°©¤å²§¼g¦rªí.Fields("ÀË¦r½s¸¹")) Then
            ½s¸¹ = ¥Ò°©¤å²§¼g¦rªí.Fields("ÀË¦r½s¸¹")
        End If
    End If
    Set ÀË¦rªí = ¥Ò°©¤åÀË¦rªí
ElseIf ¤¤¬ã°|·¡¨t¤å¦r(¨t²Î¦rÅé) Then
    If ¨t²Î¦rÅé <> "¤¤¬ã°|·¡¨tÂ²©­¤å¦r" Then
        ·¡¨t¤å¦r²§¼g¦rªí.Seek "=", ½s¸¹
        If Not IsNull(·¡¨t¤å¦r²§¼g¦rªí.Fields("ÀË¦r½s¸¹")) Then
            ½s¸¹ = ·¡¨t¤å¦r²§¼g¦rªí.Fields("ÀË¦r½s¸¹")
        End If
    End If
    Set ÀË¦rªí = ·¡¨t¤å¦rÀË¦rªí
Else
    Set ÀË¦rªí = ·¢®ÑÀË¦rªí
    ÀË¬d²Õ¦r²Å¸¹ = True
End If
   
¼Ğ°O­Ó¼Æ = 0
¤»®Ñ = 0
ÀË¦rªí.Index = "½s¸¹"
ÀË¦rªí.Seek "=", ½s¸¹


If Not ÀË¦rªí.NoMatch Then
    If Not IsNull(ÀË¦rªí.Fields("³s±µ²Å¸¹")) Then
        ¤À¸Ñ = ÀË¦rªí.Fields("³s±µ²Å¸¹")
    Else
        ¤À¸Ñ = 4
    End If
    If Not IsNull(ÀË¦rªí.Fields("³¡¥ó§Ç")) Then
        ³¡¥ó§Ç = ÀË¦rªí.Fields("³¡¥ó§Ç")
    Else
        ³¡¥ó§Ç = ""
    End If
End If

If ÀË¬d²Õ¦r²Å¸¹ And (½s¸¹ < 19783) Then
    ¤£¬O²Õ¦r²Å¸¹ = ¬O§_¬°²Õ¦r²Å¸¹(mdiº~¦r¦r§Î.txt¦r§Î.Text, 1, 14) = 0
Else
    ¤£¬O²Õ¦r²Å¸¹ = True
End If

'If ¬O§_¬°²Õ¦r²Å¸¹(mdiº~¦r¦r§Î.txt¦r§Î.Text, 1, 14) = 0 Then
If ¤£¬O²Õ¦r²Å¸¹ Then

   tree¦r§Î¾ğª¬µ²ºc.Clear
   tree¦r§Î¾ğª¬µ²ºc.Redraw = False

   If Not ÀË¦rªí.NoMatch Then
      If ÀË¦rªí.Fields("¦rÅé") = 0 Then
         ¦r«¬ÀÉ = Âà´«Åã¥Ü¦r«¬(²{¥Î¦rÅé)
      Else
         ¦rÅé½s¸¹ = ÀË¦rªí.Fields("¦rÅé")
         ¦r«¬ÀÉ = Âà´«Åã¥Ü¦r«¬(°Ï°ì¦rÅé°}¦C(¦rÅé½s¸¹))
         'If ¦rÅé½s¸¹ = 13 Then ¦r«¬ÀÉ = "¥_®v¤j»¡¤å¤p½f"
         'If ¦rÅé½s¸¹ = 14 Then ¦r«¬ÀÉ = "¥_®v¤j»¡¤å­«¤å"
         'If ¦rÅé½s¸¹ = 15 Then ¦r«¬ÀÉ = "¤¤¬ã°|ª÷¤å"
         'If ¦rÅé½s¸¹ = 16 Then ¦r«¬ÀÉ = "¤¤¬ã°|¥Ò°©¤å"
         'If ¦rÅé½s¸¹ = 17 Then ¦r«¬ÀÉ = "¤¤¬ã°|·¡¨tÂ²©­¤å¦r"
      End If
      
      If Not IsNull(ÀË¦rªí.Fields("¦r§Î")) Then
         ¦r§Î = ÀË¦rªí.Fields("¦r§Î")
      Else
         If Not IsNull(ÀË¦rªí.Fields("¦r½X")) Then
            ¦r§Î = ÀË¦rªí.Fields("¦r½X")
         Else
            ¦r§Î = "¡´"
         End If
      End If
      
      If Not IsNull(ÀË¦rªí.Fields("³¡¥ó§Ç")) Then
         ³¡¥ó§Ç = ÀË¦rªí.Fields("³¡¥ó§Ç")
      Else
         ³¡¥ó§Ç = ""
      End If
      
      If ¨t²Î¦rÅé = "¥_®v¤j»¡¤å¤p½f" Or ¨t²Î¦rÅé = "¥_®v¤j»¡¤å­«¤å" Then
         If Not IsNull(ÀË¦rªí.Fields("¤»®Ñ")) Then ¤»®Ñ = ÀË¦rªí.Fields("¤»®Ñ")
         If Not IsNull(ÀË¦rªí.Fields("¸Ñ§Î")) Then ¸Ñ§Î = ÀË¦rªí.Fields("¸Ñ§Î")
         If ¸Ñ§Î = "¡´" Or ¸Ñ§Î = "¡³" Or ¸Ñ§Î = "¡¼" Or ¸Ñ§Î = "¡½" Then GoTo ¸ü¤J¤p½fµL¸Ñ§Î
      ElseIf ¤¤¬ã°|ª÷¤å(¨t²Î¦rÅé) Or ¤¤¬ã°|¥Ò°©¤å(¨t²Î¦rÅé) Or ¤¤¬ã°|·¡¨t¤å¦r(¨t²Î¦rÅé) Then
         If Not IsNull(ÀË¦rªí.Fields("¸Ñ§Î")) Then ¸Ñ§Î = ÀË¦rªí.Fields("¸Ñ§Î")
         If ¸Ñ§Î = "¡¼" Then GoTo ¸ü¤J¥j¤åµL¸Ñ§Î
       End If
           
       If ÀË¦rªí.Fields("³s±µ²Å¸¹") = 0 Then
¸ü¤J¥j¤åµL¸Ñ§Î:

         'tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î
         If ¨t²Î¦rÅé = "¤¤¬ã°|ª÷¤å" Then
            tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î
         Else
            tree¦r§Î¾ğª¬µ²ºc.AddItem val¦r§Î
         End If
         
         tree¦r§Î¾ğª¬µ²ºc.Image(0) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf
         If ¤¤¬ã°|·¢®Ñ(¨t²Î¦rÅé) Then
            tree¦r§Î¾ğª¬µ²ºc.ItemFontName(0) = ¦r«¬ÀÉ
         Else
            tree¦r§Î¾ğª¬µ²ºc.ItemFontName(0) = ¨t²Î¦rÅé
         End If
         If Not IsNull(ÀË¦rªí.Fields("½s¸¹")) Then
            tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(0) = ÀË¦rªí.Fields("½s¸¹")
         Else
            tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(0) = 0
         End If
         If ¸Ñ§Î <> "¡¼" Then
            tree¦r§Î¾ğª¬µ²ºc.ItemTag(0) = ¦r§Î¸`ÂI¼Ğ°O
         Else
            tree¦r§Î¾ğª¬µ²ºc.ItemTag(0) = ºc¦r¦¡¸`ÂI¼Ğ°O
         End If
      Else
      
¸ü¤J¤p½fµL¸Ñ§Î:
         'tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î
         If ¨t²Î¦rÅé = "¤¤¬ã°|ª÷¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|¥Ò°©¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|·¡¨tÂ²©­¤å¦r" Or ¨t²Î¦rÅé = "¥_®v¤j»¡¤å¤p½f" Then
            tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î
         Else
            tree¦r§Î¾ğª¬µ²ºc.AddItem val¦r§Î
         End If
         tree¦r§Î¾ğª¬µ²ºc.Image(0) = tree¦r§Î¾ğª¬µ²ºc.PictureClosed
         If ¤¤¬ã°|·¢®Ñ(¨t²Î¦rÅé) Then
            tree¦r§Î¾ğª¬µ²ºc.ItemFontName(0) = ¦r«¬ÀÉ
         Else
            tree¦r§Î¾ğª¬µ²ºc.ItemFontName(0) = ¨t²Î¦rÅé
         End If
         If Not IsNull(ÀË¦rªí.Fields("½s¸¹")) Then
            tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(0) = ÀË¦rªí.Fields("½s¸¹")
         Else
            tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(0) = 0
         End If
         If Not IsNull(ÀË¦rªí.Fields("¦r§Î")) Then
            tree¦r§Î¾ğª¬µ²ºc.ItemTag(0) = ¦r§Î¸`ÂI¼Ğ°O
         Else
            tree¦r§Î¾ğª¬µ²ºc.ItemTag(0) = ºc¦r¦¡¸`ÂI¼Ğ°O
         End If
         
         ¸ü¤J¨Ï¥Î¦r§Î 0, Âà´«¦rÅé(¦r«¬ÀÉ)
         tree¦r§Î¾ğª¬µ²ºc.Expand(0) = True
      End If
      
   Else
   
      tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, 0
      tree¦r§Î¾ğª¬µ²ºc.Image(0) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf
      tree¦r§Î¾ğª¬µ²ºc.ItemFontName(0) = Âà´«Åã¥Ü¦r«¬(²{¥Î¦rÅé)
      tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(0) = -999999
      tree¦r§Î¾ğª¬µ²ºc.ItemTag(0) = ¨ä¥L¸`ÂI¼Ğ°O
   End If

   'If ¤»®Ñ > 0 Then

    'Select Case ¤»®Ñ
    'Case 1: tree¦r§Î¾ğª¬µ²ºc.ItemMark(0) = ¶H§Î¥N½X
    'Case 2: tree¦r§Î¾ğª¬µ²ºc.ItemMark(0) = «ü¨Æ¥N½X
    'Case 3: tree¦r§Î¾ğª¬µ²ºc.ItemMark(0) = ·|·N¥N½X
    'Case 4: tree¦r§Î¾ğª¬µ²ºc.ItemMark(0) = §ÎÁn¥N½X
    'End Select

    '¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
   'End If
Else
   tree¦r§Î¾ğª¬µ²ºc.Clear
   tree¦r§Î¾ğª¬µ²ºc.Redraw = False
   tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î
   tree¦r§Î¾ğª¬µ²ºc.Image(0) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf
   tree¦r§Î¾ğª¬µ²ºc.ItemFontName(0) = Âà´«Åã¥Ü¦r«¬(²{¥Î¦rÅé)
   tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(0) = -999999
   tree¦r§Î¾ğª¬µ²ºc.ItemTag(0) = ¨ä¥L¸`ÂI¼Ğ°O
End If

If ¼Ğ°O­Ó¼Æ > 0 Then
    tree¦r§Î¾ğª¬µ²ºc.ViewStyleEx = TLVIEWSEX_MARKPM
Else
    tree¦r§Î¾ğª¬µ²ºc.ViewStyleEx = TLVIEWSEX_PLUSMIN
End If

tree¦r§Î¾ğª¬µ²ºc.Redraw = True
µ²ºcª¬ºA¦C = ""
mdiº~¦r¦r§Î.txtª¬ºA = µ²ºcª¬ºA¦C

Screen.MousePointer = ccDefault

End Sub

Public Sub ¸ü¤J¨Ï¥Î¦r§Î(¦r§Î¸`ÂI As Long, ¨t²Î¦rÅé As String)

Dim i As Integer
Dim ¦r§Î As String, ¦r«¬ÀÉ As String, ³¡¥ó§Ç As String
Dim ½s¸¹ As Long
Dim ¸Ñ§Î As String

i = 1
³¡¥ó§Ç = ""
½s¸¹ = tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(¦r§Î¸`ÂI)

If ¨t²Î¦rÅé = "¥_®v¤j»¡¤å¤p½f" Or ¨t²Î¦rÅé = "¥_®v¤j»¡¤å­«¤å" Then
    Set ÀË¦rªí = ¤p½fÀË¦rªí
ElseIf ¨t²Î¦rÅé = "¤¤¬ã°|ª÷¤å" Then
    Set ÀË¦rªí = ª÷¤åÀË¦rªí
ElseIf ¨t²Î¦rÅé = "¤¤¬ã°|¥Ò°©¤å" Then
    Set ÀË¦rªí = ¥Ò°©¤åÀË¦rªí
ElseIf ¨t²Î¦rÅé = "¤¤¬ã°|·¡¨tÂ²©­¤å¦r" Then
    Set ÀË¦rªí = ·¡¨t¤å¦rÀË¦rªí
Else
    Set ÀË¦rªí = ·¢®ÑÀË¦rªí
End If

If ½s¸¹ = 0 Then
   ÀË¦rªí.Index = "¦r§Î"
   ÀË¦rªí.Seek "=", tree¦r§Î¾ğª¬µ²ºc.List(¦r§Î¸`ÂI)
Else
   ÀË¦rªí.Index = "½s¸¹"
   ÀË¦rªí.Seek "=", ½s¸¹
End If

If ¨t²Î¦rÅé <> "¥_®v¤j»¡¤å¤p½f" And ¨t²Î¦rÅé <> "¥_®v¤j»¡¤å­«¤å" And ¨t²Î¦rÅé <> "¤¤¬ã°|ª÷¤å" And ¨t²Î¦rÅé <> "¤¤¬ã°|¥Ò°©¤å" And ¨t²Î¦rÅé <> "¤¤¬ã°|·¡¨tÂ²©­¤å¦r" Then GoTo ¸ü¤J·¢®Ñµ²ºc

If Not ÀË¦rªí.NoMatch() Then
    If ¨t²Î¦rÅé = "¤¤¬ã°|ª÷¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|¥Ò°©¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|·¡¨tÂ²©­¤å¦r" Then
        ³¡¥ó§Ç = ÀË¦rªí.Fields("¸Ñ§Î")
    ElseIf ¨t²Î¦rÅé = "¥_®v¤j»¡¤å¤p½f" Or ¨t²Î¦rÅé = "¥_®v¤j»¡¤å­«¤å" Then
        If Not IsNull(ÀË¦rªí.Fields("¸Ñ§Î")) Then
            If mdiº~¦r¦r§Î.mnu_»¡¤å¸Ñ§Î¶¶§Ç.Checked = True Then
                ³¡¥ó§Ç = ÀË¦rªí.Fields("¸Ñ§Î")
            Else
                ³¡¥ó§Ç = ÀË¦rªí.Fields("¸Ñ§Î¤G")
            End If
        End If
    End If
End If

Do Until i > Len(³¡¥ó§Ç)

    ¦r§Î = Mid(³¡¥ó§Ç, i, 1)
    ²Õ¦r²Å¸¹ = ¬O§_¬°²Õ¦r²Å¸¹(¦r§Î, 4, 14)
    'If ²Õ¦r²Å¸¹ >= 4 And ²Õ¦r²Å¸¹ <= 11 Then             '¤è«K²Å¸¹
    '   ¦r§Î = Mid(³¡¥ó§Ç, i + 1, 1)
    '   ÀË¦rªí.Index = "¦r§Î"
    '   ÀË¦rªí.Seek "=", ¦r§Î
    '   tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
    '   tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨t²Î¦rÅé
    '   tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureClosed
    '   tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ÀË¦rªí.Fields("½s¸¹")
    '   If ²Õ¦r²Å¸¹ >= 4 And ²Õ¦r²Å¸¹ <= 5 Then
    '        tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¤G¥N½X
    '   ElseIf ²Õ¦r²Å¸¹ >= 6 And ²Õ¦r²Å¸¹ <= 8 Then
    '        tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¤T¥N½X
    '   ElseIf ²Õ¦r²Å¸¹ >= 9 And ²Õ¦r²Å¸¹ <= 11 Then
    '        tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¥|¥N½X
    '   End If
    '   ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
    '   i = i + 1
    If ²Õ¦r²Å¸¹ = 14 Or ¦r§Î = "¡´" Or ¦r§Î = "¡³" Or ¦r§Î = "¡¼" Or ¦r§Î = "¡½" Then      '¯Ê¦rş
       tree¦r§Î¾ğª¬µ²ºc.AddItem "ş", ¦r§Î¸`ÂI
       tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf
       tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = -999999
       tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨ä¥L¸`ÂI¼Ğ°O
       ³B²z»¡¤å¼Ğ¥Ü ³¡¥ó§Ç, i
    ElseIf UCase(Mid(³¡¥ó§Ç, i + 1, 1)) = "L" Then
       i = i + 1
       tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
       tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = imgQuestion
       tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = "¼Ğ·¢Åé"
       ÀË¦rªí.Index = "¦r§Î"
       ÀË¦rªí.Seek "=", ¦r§Î
       tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ÀË¦rªí.Fields("·¢®Ñ½s¸¹") '-999999
       tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¦r§Î¸`ÂI¼Ğ°O
       ³B²z»¡¤å¼Ğ¥Ü ³¡¥ó§Ç, i
    ElseIf UCase(Mid(³¡¥ó§Ç, i + 1, 1)) = "D" Then
       i = i + 1
       tree¦r§Î¾ğª¬µ²ºc.AddItem "ş", ¦r§Î¸`ÂI
       tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf
       tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = -999999
       tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨ä¥L¸`ÂI¼Ğ°O
       ³B²z»¡¤å¼Ğ¥Ü ³¡¥ó§Ç, i
    Else
    '¨ä¥¦
    
       If ²Õ¦r²Å¸¹ >= 4 And ²Õ¦r²Å¸¹ <= 11 Then
          ¦r§Î = Mid(³¡¥ó§Ç, i + 1, 1)
          i = i + 1
          If UCase(Mid(³¡¥ó§Ç, i + 1, 1)) = "L" Then
             i = i + 1
             tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
             tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = imgQuestion
             tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = "¼Ğ·¢Åé"
             ÀË¦rªí.Index = "¦r§Î"
             ÀË¦rªí.Seek "=", ¦r§Î
             tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ÀË¦rªí.Fields("·¢®Ñ½s¸¹") '-999999
             tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¦r§Î¸`ÂI¼Ğ°O
             ³B²z»¡¤å¼Ğ¥Ü ³¡¥ó§Ç, i
             GoTo ¸ü¤JµL¸Ñ§Î¤G
          ElseIf UCase(Mid(³¡¥ó§Ç, i + 1, 1)) = "D" Then
             i = i + 1
             tree¦r§Î¾ğª¬µ²ºc.AddItem "ş", ¦r§Î¸`ÂI
             tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf
             tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = -999999
             tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨ä¥L¸`ÂI¼Ğ°O
             ³B²z»¡¤å¼Ğ¥Ü ³¡¥ó§Ç, i
             GoTo ¸ü¤JµL¸Ñ§Î¤G
          End If
       End If
       
       ÀË¦rªí.Index = "¦r§Î"
       ÀË¦rªí.Seek "=", ¦r§Î
       If Not ÀË¦rªí.NoMatch Then
          Do While Not ÀË¦rªí.EOF
'             If ÀË¦rªí.Fields("¦rÅé") = 0 Then Exit Do
             If ¨t²Î¦rÅé = "¥_®v¤j»¡¤å¤p½f" Or ¨t²Î¦rÅé = "¥_®v¤j»¡¤å­«¤å" Then
                If ÀË¦rªí.Fields("­«½Æ") = 0 Then Exit Do
                ÀË¦rªí.MoveNext
             Else
                Exit Do
             End If
             
          Loop
          If Not ÀË¦rªí.EOF Then
          
             ¸Ñ§Î = ÀË¦rªí.Fields("¸Ñ§Î")
             If ¸Ñ§Î = "¡´" Or ¸Ñ§Î = "¡³" Or ¸Ñ§Î = "¡¼" Or ¸Ñ§Î = "¡½" Then
                tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
                tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = °Ï°ì¦rÅé°}¦C(ÀË¦rªí.Fields("¦rÅé"))
                tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureClosed
                tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ÀË¦rªí.Fields("½s¸¹")
                tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¦r§Î¸`ÂI¼Ğ°O
                ³B²z»¡¤å¼Ğ¥Ü ³¡¥ó§Ç, i
                tree¦r§Î¾ğª¬µ²ºc.AddItem "ş", tree¦r§Î¾ğª¬µ²ºc.NewIndex
                tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = °Ï°ì¦rÅé°}¦C(ÀË¦rªí.Fields("¦rÅé"))
                tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf
                tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = -999999
                tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨ä¥L¸`ÂI¼Ğ°O
                GoTo ¸ü¤JµL¸Ñ§Î¤G
             End If
             
             If ÀË¦rªí.Fields("³s±µ²Å¸¹") = 0 Then
                tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
                tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = °Ï°ì¦rÅé°}¦C(ÀË¦rªí.Fields("¦rÅé"))
                
                ³B²z»¡¤å¼Ğ¥Ü ³¡¥ó§Ç, i
                
                tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf
                If Not IsNull(ÀË¦rªí.Fields("½s¸¹")) Then
                    If ÀË¦rªí.Fields("½s¸¹") > 0 Then
                        tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ÀË¦rªí.Fields("½s¸¹")
                        tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¦r§Î¸`ÂI¼Ğ°O
                    Else
                        tree¦r§Î¾ğª¬µ²ºc.List(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = "ş"
                        tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = -999999
                        tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨ä¥L¸`ÂI¼Ğ°O
                    End If
                Else
                   tree¦r§Î¾ğª¬µ²ºc.List(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = "ş"
                   tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = -999999
                   tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨ä¥L¸`ÂI¼Ğ°O
                End If
             Else
                tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
                tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = °Ï°ì¦rÅé°}¦C(ÀË¦rªí.Fields("¦rÅé"))
                tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureClosed
                tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ÀË¦rªí.Fields("½s¸¹")
                tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¦r§Î¸`ÂI¼Ğ°O
                
                ³B²z»¡¤å¼Ğ¥Ü ³¡¥ó§Ç, i
                
                tree¦r§Î¾ğª¬µ²ºc.AddItem "", tree¦r§Î¾ğª¬µ²ºc.NewIndex
                tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf
             End If
          Else
            tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
            tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureMark
            tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = °Ï°ì¦rÅé°}¦C(ÀË¦rªí.Fields("¦rÅé"))
          End If
       Else
            tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
            tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureMark
            tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = °Ï°ì¦rÅé°}¦C(ÀË¦rªí.Fields("¦rÅé"))
       End If
    End If
¸ü¤JµL¸Ñ§Î¤G:
   i = i + 1
Loop

Exit Sub

¸ü¤J·¢®Ñµ²ºc:

If Not ÀË¦rªí.NoMatch() Then
   If Not IsNull(ÀË¦rªí.Fields("³¡¥ó§Ç")) Then ³¡¥ó§Ç = ÀË¦rªí.Fields("³¡¥ó§Ç")
End If

Do Until i > Len(³¡¥ó§Ç)

    ¦r§Î = Mid(³¡¥ó§Ç, i, 1)
    If ¬O§_¬°²Õ¦r²Å¸¹(¦r§Î, 4, 11) > 0 Then               '¤è«K²Å¸¹
       ¦r§Î = Mid(³¡¥ó§Ç, i, 2)
       tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
       tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf
       tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = -999999
       tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨ä¥L¸`ÂI¼Ğ°O
       i = i + 1
    ElseIf ¬O§_¬°²Õ¦r²Å¸¹(¦r§Î, 14, 14) > 0 Then          '¯Ê¦rş
       tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
       tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf
       tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = -999999
       tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨ä¥L¸`ÂI¼Ğ°O
    Else                                                  '¨ä¥¦
       ÀË¦rªí.Index = "¦r§Î"
       ÀË¦rªí.Seek "=", ¦r§Î
       If Not ÀË¦rªí.NoMatch Then
          Do While Not ÀË¦rªí.EOF
'             If ÀË¦rªí.Fields("¦rÅé") = 0 Then Exit Do
             If Not IsNull(ÀË¦rªí.Fields("¦r§Î")) Then Exit Do
             ÀË¦rªí.MoveNext
          Loop
          If Not ÀË¦rªí.EOF Then
             If ÀË¦rªí.Fields("³s±µ²Å¸¹") = 0 Then
                tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
                If ¨t²Î¦rÅé = "¥_®v¤j»¡¤å¤p½f" Or ¨t²Î¦rÅé = "¥_®v¤j»¡¤å­«¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|ª÷¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|¥Ò°©¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|·¡¨tÂ²©­¤å¦r" Then
                    tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨t²Î¦rÅé
                ElseIf Åã¥Ü¦r«¬ = "²Ó©úÅé" Then
                    tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = Åã¥Ü¦r«¬
                End If
                tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf
'                tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = 1
                If Not IsNull(ÀË¦rªí.Fields("½s¸¹")) Then
                   tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ÀË¦rªí.Fields("½s¸¹")
                   tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¦r§Î¸`ÂI¼Ğ°O
                Else
                   tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = 0
                   tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨ä¥L¸`ÂI¼Ğ°O

                End If
             Else
                tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
                If ¨t²Î¦rÅé = "¥_®v¤j»¡¤å¤p½f" Or ¨t²Î¦rÅé = "¥_®v¤j»¡¤å­«¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|ª÷¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|¥Ò°©¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|·¡¨tÂ²©­¤å¦r" Then
                    tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨t²Î¦rÅé
                ElseIf Åã¥Ü¦r«¬ = "²Ó©úÅé" Then
                    tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = Åã¥Ü¦r«¬
                End If
                tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureClosed
                tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ÀË¦rªí.Fields("½s¸¹")
                tree¦r§Î¾ğª¬µ²ºc.ItemTag(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¦r§Î¸`ÂI¼Ğ°O

                tree¦r§Î¾ğª¬µ²ºc.AddItem "", tree¦r§Î¾ğª¬µ²ºc.NewIndex
                tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf
             End If
          Else
             tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
             tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureMark
'             tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = 1
                If ¨t²Î¦rÅé = "¥_®v¤j»¡¤å¤p½f" Or ¨t²Î¦rÅé = "¥_®v¤j»¡¤å­«¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|ª÷¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|¥Ò°©¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|·¡¨tÂ²©­¤å¦r" Then
                    tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨t²Î¦rÅé
                End If
          End If
       Else
          tree¦r§Î¾ğª¬µ²ºc.AddItem ¦r§Î, ¦r§Î¸`ÂI
          tree¦r§Î¾ğª¬µ²ºc.Image(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = tree¦r§Î¾ğª¬µ²ºc.PictureMark
                If ¨t²Î¦rÅé = "¥_®v¤j»¡¤å¤p½f" Or ¨t²Î¦rÅé = "¥_®v¤j»¡¤å­«¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|ª÷¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|¥Ò°©¤å" Or ¨t²Î¦rÅé = "¤¤¬ã°|·¡¨tÂ²©­¤å¦r" Then
                    tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¨t²Î¦rÅé
                End If
       End If
    End If
   i = i + 1
Loop

End Sub



Private Sub imglock_Click()

If imglock.Tag = 0 Then
    imglock.Tag = 1
    imglock.Picture = imgPinPush.Picture
    imglock.ToolTipText = "¸Ñ°£Âê©w"
    frm¦r§Îµ²ºc.Caption = "¦r§Îµ²ºc(Âê©w)"
Else
    imglock.Tag = 0
    imglock.Picture = imgPin.Picture
    imglock.ToolTipText = "Âê©w"
    frm¦r§Îµ²ºc.Caption = "¦r§Îµ²ºc"
End If

End Sub

Private Sub tree¦r§Î¾ğª¬µ²ºc_Click()

Dim ¦rÅé As String
Dim ¦r§Î As String
Dim ½s¸¹ As Long

If tree¦r§Î¾ğª¬µ²ºc.ListIndex <> -1 Then
   If tree¦r§Î¾ğª¬µ²ºc.List(0) <> "" Then
      ¦rÅé = tree¦r§Î¾ğª¬µ²ºc.ItemFontName(tree¦r§Î¾ğª¬µ²ºc.ListIndex)
      ¦r§Î = tree¦r§Î¾ğª¬µ²ºc.List(tree¦r§Î¾ğª¬µ²ºc.ListIndex)
      ½s¸¹ = tree¦r§Î¾ğª¬µ²ºc.ItemLngValue(tree¦r§Î¾ğª¬µ²ºc.ListIndex)
      Â^¨úÄİ©Ê ¦rÅé, ¦r§Î, ½s¸¹
      Â^¨úºc¦r¦¡ ¦rÅé, ¦r§Î, ½s¸¹
      If mdiº~¦r¦r§Î.txt¦r§Î.font.Name = "¼Ğ·¢Åé" Then ©ì¦²¦r¦ê = tree¦r§Î¾ğª¬µ²ºc.List(tree¦r§Î¾ğª¬µ²ºc.ListIndex)
      If ±Ò°Ê²§Åé¦rªí Then frm²§Åé¦rªí.¸ü¤J¦r§Î ¦rÅé, ¦r§Î, ½s¸¹
      If ±Ò°Ê¦r§ÎºtÅÜ Then frm¦r§ÎºtÅÜ.¸ü¤J¦r§Î ¦rÅé, ¦r§Î, ½s¸¹
      If ±Ò°Ê¦r§Î¯Á¤Ş Then frm¦r§Î¯Á¤Ş.¸ü¤J¦r§Î ¦rÅé, ¦r§Î, ½s¸¹
      If ±Ò°Ê²§Åé¦r®Ú Then frm²§Åé¦r®Ú.¸ü¤J¦r§Î ¦rÅé, ¦r§Î, ½s¸¹
    End If
End If

End Sub

Private Sub tree¦r§Î¾ğª¬µ²ºc_GotFocus()

²{¥Îµøµ¡¥N½X = ¦r§Îµ²ºc¥N½X

End Sub

Private Sub tree¦r§Î¾ğª¬µ²ºc_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
' Initiates dragging only after moving at least 100 twips with the mouse depressed
If (Button And 1) And (XCheck > 0) And (YCheck > 0) And ((Abs(XCheck - x) > 150) Or (Abs(YCheck - y) > 150)) Then
    XCheck = 0
    YCheck = 0  ' Reset mouse coordinates
    If tree¦r§Î¾ğª¬µ²ºc.ListIndex >= 0 Then
        tree¦r§Î¾ğª¬µ²ºc.BeforeDrag
        tree¦r§Î¾ğª¬µ²ºc.Drag 1         ' Start drag
    End If
End If

'If Button = 1 Then
'    tree¦r§Î¾ğª¬µ²ºc.BeforeDrag
'    tree¦r§Î¾ğª¬µ²ºc.Drag 1
'End If

End Sub

Private Sub tree¦r§Î¾ğª¬µ²ºc_Expand(ByVal i As Long)

'If tree¦r§Î¾ğª¬µ²ºc.ListIndex <> -1 And Not (tree¦r§Î¾ğª¬µ²ºc.Image(0) = tree¦r§Î¾ğª¬µ²ºc.PictureLeaf And tree¦r§Î¾ğª¬µ²ºc.List(0) = "") Then
   If tree¦r§Î¾ğª¬µ²ºc.ListCountEx(i) = 1 Then
      If tree¦r§Î¾ğª¬µ²ºc.List(i + 1) = "" Then
         Screen.MousePointer = 11
         tree¦r§Î¾ğª¬µ²ºc.RemoveItem i + 1
         tree¦r§Î¾ğª¬µ²ºc.Redraw = False
         ¸ü¤J¨Ï¥Î¦r§Î i, tree¦r§Î¾ğª¬µ²ºc.ItemFontName(i)
         If ¼Ğ°O­Ó¼Æ > 0 Then tree¦r§Î¾ğª¬µ²ºc.ViewStyleEx = TLVIEWSEX_MARKPM
         tree¦r§Î¾ğª¬µ²ºc.Redraw = True
         Screen.MousePointer = 0
      End If
   End If
'End If

End Sub


Private Sub tree¦r§Î¾ğª¬µ²ºc_DragOver(Source As Control, x As Single, y As Single, State As Integer)

tree¦r§Î¾ğª¬µ²ºc.OnDragOver x, y, State

End Sub

Private Sub tree¦r§Î¾ğª¬µ²ºc_LostFocus()

tree¦r§Î¾ğª¬µ²ºc.ListIndex = -1

End Sub

Private Sub tree¦r§Î¾ğª¬µ²ºc_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)

XCheck = x
YCheck = y

End Sub


Private Sub ³B²z»¡¤å¼Ğ¥Ü(³¡¥ó§Ç As String, ByRef i As Integer)

If UCase(Mid(³¡¥ó§Ç, i + 1, 1)) = "G" Then
    If UCase(Mid(³¡¥ó§Ç, i + 2, 1)) = "V" Then
        tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¥çÁn¥N½X
        ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
        i = i + 2
    Else
        'tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = §Î¥N½X
        '¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
        i = i + 1
    End If
ElseIf UCase(Mid(³¡¥ó§Ç, i + 1, 1)) = "M" Then
    If UCase(Mid(³¡¥ó§Ç, i + 2, 1)) = "V" Then
        tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¥çÁn¥N½X
        ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
        i = i + 2
    Else
        'tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¸q¥N½X
        '¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
        i = i + 1
    End If
ElseIf UCase(Mid(³¡¥ó§Ç, i + 1, 1)) = "V" Then
    tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = Án¥N½X
    ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
    i = i + 1
ElseIf UCase(Mid(³¡¥ó§Ç, i + 1, 1)) = "T" Then
    'tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¼Ğ¥Ü¥N½X
    '¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
    i = i + 1
ElseIf UCase(Mid(³¡¥ó§Ç, i + 1, 1)) = "U" Then
    'tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¼Ğ¥Ü¥N½X
    '¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
    i = i + 1
ElseIf Mid(³¡¥ó§Ç, i + 1, 1) = "-" Then
    If UCase(Mid(³¡¥ó§Ç, i + 2, 1)) = "+" Then
        tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¬Ù¥çÁn¥N½X
        ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
        i = i + 3
    ElseIf UCase(Mid(³¡¥ó§Ç, i + 2, 1)) = "V" Then
        tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¬ÙÁn¥N½X
        ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
        i = i + 2
    ElseIf UCase(Mid(³¡¥ó§Ç, i + 2, 1)) = "G" Then
        tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¬Ù¥N½X
        ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
        i = i + 2
    ElseIf UCase(Mid(³¡¥ó§Ç, i + 2, 1)) = "M" Then
        tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¬Ù¥N½X
        ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
        i = i + 2
    Else
        tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¬Ù¥N½X
        ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
        i = i + 1
    End If
ElseIf Mid(³¡¥ó§Ç, i + 1, 1) = "+" Then
    'tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = Án¸q¥N½X
    tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¥çÁn¥N½X
    ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
    i = i + 2
ElseIf UCase(Mid(³¡¥ó§Ç, i + 1, 1)) = "R" Then
    tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¤Ï¥N½X
    ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
    i = i + 1
ElseIf UCase(Mid(³¡¥ó§Ç, i + 1, 1)) = "I" Then
    tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ­Ë¥N½X
    ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
    i = i + 1
ElseIf UCase(Mid(³¡¥ó§Ç, i + 1, 1)) = "H" Then
    tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¥b¥N½X
    ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
    i = i + 1
ElseIf ²Õ¦r²Å¸¹ >= 4 And ²Õ¦r²Å¸¹ <= 5 Then
    tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¤G¥N½X
    ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
ElseIf ²Õ¦r²Å¸¹ >= 6 And ²Õ¦r²Å¸¹ <= 8 Then
    tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¤T¥N½X
    ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
ElseIf ²Õ¦r²Å¸¹ >= 9 And ²Õ¦r²Å¸¹ <= 11 Then
    tree¦r§Î¾ğª¬µ²ºc.ItemMark(tree¦r§Î¾ğª¬µ²ºc.NewIndex) = ¥|¥N½X
    ¼Ğ°O­Ó¼Æ = ¼Ğ°O­Ó¼Æ + 1
End If

End Sub
